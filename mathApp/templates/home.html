<!DOCTYPE html>
<html>
<body>

<h2>HTML Forms</h2>
{% for i in list %}
  <a>|{{ i.number1 }} + {{ i.number2 }} = {{ i.total }} |</a>
  
{% endfor %}
<div class="">
  <div id="form-wrapper">
  <form method="">
    <!-- {{ form.as_p }} {% csrf_token %} -->
    <label for="num1">num1:</label><br>
    <input type="text" id="num1" name="num1" ><br>
    <label for="num2">num2:</label><br>
    <input type="text" id="num2" name="num2" ><br><br>
    <input type="submit" value="Submit" >
  </form> 
  <div id="a"></div>
  </div>
</div>
<script type="text/javascript">
  let url_api = 'http://127.0.0.1:2001/api-twonumber/';
  function x(){
    let num1 = document.getElementById('num1').value;
    let num2 = document.getElementById('num2').value;
    url_api = url_api + num1 + '/'+num2+'/';
  }
    //let wrapper = document.getElementById('a');
    let form = document.getElementById('form-wrapper');
    form.addEventListener('submit', function(e){
      e.preventDefault();
      x();
      console.log(url_api);
      fetch(url_api)
      .then(function(response) {
        if(!response.ok) {
           throw new Error("HTTP error, status = " + response.status);
        }
        let myjson_data = response.json();
        return myjson_data;
      })
      .then(function(myjson){
        let p = '<p>'+myjson.total+'</p>';
        //response.json().then(data =>{
          //let p = '<p>'+data.total+'</p>';
          document.getElementById('a').innerHTML = p;
          url_api = 'http://127.0.0.1:2001/api-twonumber/';
        //})
      })
      .catch(function(error) {
        console.log('Erro///////////////');
        url_api = 'http://127.0.0.1:2001/api-twonumber/';
      })
    });
  
</script>
</body>
</html>
